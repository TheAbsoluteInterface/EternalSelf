<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Blue Sigil Maker</title>
<style>
  :root{
    --bg-0:#0b1220;
    --bg-1:#0f1a33;
    --bg-2:#0e2347;
    --accent:#4aa3ff;
    --accent-2:#7cc7ff;
    --ink:#e9f3ff;
    --muted:#9dbce6;
    --ring:#1c2f57;
    --shadow: 0 10px 30px rgba(16, 64, 150, .35);
    --radius:14px;
  }

  html, body {
    height: 100%;
    background: radial-gradient(1200px 800px at 70% -10%, var(--bg-2), var(--bg-1)) fixed,
                linear-gradient(180deg, var(--bg-0), var(--bg-1));
    color: var(--ink);
    font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif;
    margin: 0;
  }

  .wrap {
    max-width: 1100px;
    margin: 32px auto 56px;
    padding: 0 20px;
  }

  header {
    display: flex;
    align-items: center;
    gap: 16px;
    margin-bottom: 22px;
  }

  .logo {
    width: 42px; height: 42px; border-radius: 12px;
    display: grid; place-items: center;
    background: conic-gradient(from 0turn, #1e4aa8, #2a6de0, #48a8ff, #1e4aa8);
    box-shadow: var(--shadow);
  }
  .logo svg { filter: drop-shadow(0 2px 6px rgba(0,0,0,.35)); }

  h1 {
    font-size: clamp(22px, 3.4vw, 34px);
    letter-spacing: 0.5px;
    margin: 0;
  }

  .card {
    background: linear-gradient(180deg, rgba(255,255,255,.02), rgba(255,255,255,.01));
    border: 1px solid rgba(122, 176, 255, .15);
    backdrop-filter: blur(6px);
    border-radius: var(--radius);
    box-shadow: var(--shadow);
  }

  .grid {
    display: grid;
    grid-template-columns: 1.1fr 1fr;
    gap: 18px;
  }

  @media (max-width: 980px){
    .grid { grid-template-columns: 1fr; }
  }

  .controls {
    padding: 18px;
    display: grid;
    gap: 14px;
  }

  label { font-weight: 600; color: var(--ink); }
  .muted { color: var(--muted); font-size: .95rem; }

  .row {
    display: grid;
    gap: 8px;
  }

  .inline {
    display: flex; flex-wrap: wrap; gap: 12px 18px; align-items: center;
  }

  input[type="text"]{
    width: 100%; padding: 12px 14px;
    font-size: 16px; color: var(--ink);
    background: #091326;
    border: 1px solid #18305d;
    border-radius: 10px;
    outline: none;
    transition: border-color .2s ease;
  }
  input[type="text"]:focus { border-color: var(--accent); box-shadow: 0 0 0 3px rgba(74,163,255,.15); }

  input[type="range"]{
    width: 240px;
  }

  .switch {
    display:inline-flex; gap: 10px; align-items: center; user-select: none;
    padding: 8px 10px; border-radius: 999px; border: 1px solid #18305d; background: #0a1730;
  }
  .switch input{ transform: scale(1.2); accent-color: var(--accent); }

  .btns { display: flex; flex-wrap: wrap; gap: 10px; }
  button {
    appearance: none; border: none; cursor: pointer;
    padding: 10px 14px; border-radius: 10px;
    background: linear-gradient(180deg, var(--accent), #2e7fe6);
    color: white; font-weight: 700; letter-spacing: .3px;
    box-shadow: 0 8px 18px rgba(57, 136, 255, .35);
  }
  button.quiet {
    background: #0a1730; color: var(--ink);
    border: 1px solid #1e3a70;
    box-shadow: none; font-weight: 600;
  }

  .canvas-wrap {
    padding: 12px;
  }
  .canvas-inner {
    aspect-ratio: 1/1;
    width: 100%;
    background:
      radial-gradient(closest-side, rgba(13, 31, 70, 0.6), rgba(9, 20, 44, 0.6) 70%, transparent 71%) center/75% 75% no-repeat,
      radial-gradient(closest-side, rgba(9, 20, 44, 0.8), rgba(9, 20, 44, 0.8)) center/100% 100% no-repeat;
    border-radius: 16px;
    display:grid; place-items:center;
  }
  canvas {
    width: min(90vmin, 680px);
    height: auto;
    max-width: 100%;
    max-height: 100%;
  }

  footer {
    margin-top: 22px; color: var(--muted); font-size: .9rem;
  }

  details {
    margin-top: 6px;
  }
  details summary {
    cursor: pointer; color: var(--accent-2);
  }

  .pill {
    display:inline-block; padding: 4px 8px; border-radius: 999px;
    background: #0a1730; border: 1px solid #1e3a70; color: var(--muted); font-size: 12px;
    margin-top: 4px;
  }
</style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="logo" aria-hidden="true">
        <svg width="26" height="26" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
          <circle cx="12" cy="12" r="9"></circle>
          <path d="M12 3v6l4 2"></path>
        </svg>
      </div>
      <div>
        <h1>Sigil Maker ‚Äî Blue Theme</h1>
        <div class="muted">Type your intention, tune the options, and craft a unique sigil. ‚úß</div>
      </div>
    </header>

    <div class="grid">
      <!-- Controls -->
      <section class="card controls" aria-label="Controls">
        <div class="row">
          <label for="phrase">Intention phrase</label>
          <input id="phrase" type="text" placeholder="e.g. I FEARLESSLY TRUST MY INNER WISDOM" />
          <span id="processed" class="pill" title="Processed sequence"></span>
        </div>

        <div class="row inline" role="group" aria-label="Text options">
          <label class="switch"><input type="checkbox" id="removeVowels" checked> Remove vowels</label>
          <label class="switch"><input type="checkbox" id="removeDuplicates" checked> Remove duplicates</label>
          <label class="switch"><input type="checkbox" id="keepNumbers"> Keep numbers</label>
        </div>

        <div class="row inline" role="group" aria-label="Style options">
          <label class="switch"><input type="checkbox" id="showGuide" checked> Show outer guide</label>
          <label class="switch"><input type="checkbox" id="showLetters"> Show letter ring</label>
          <label class="switch"><input type="checkbox" id="smooth"> Smooth path</label>
          <label class="switch"><input type="checkbox" id="closePath"> Close path</label>
        </div>

        <div class="row inline" role="group" aria-label="Geometry">
          <div class="muted">Rotation</div>
          <input id="rotation" type="range" min="0" max="359" value="0">
          <div class="muted" id="deg">0¬∞</div>

          <div class="muted" style="margin-left:14px;">Thickness</div>
          <input id="thickness" type="range" min="1" max="12" value="5">
          <div class="muted" id="thk">5</div>
        </div>

        <div class="btns">
          <button id="randomize">Randomize rotation</button>
          <button id="download">Download PNG</button>
          <button id="clear" class="quiet">Clear</button>
        </div>

        <details>
          <summary>How it works</summary>
          <p class="muted">
            The phrase is cleaned (uppercase, optional vowel &amp; duplicate removal). Remaining characters A‚ÄìZ are mapped evenly
            around a circle (starting at the top). The sigil is the path connecting those points. Start and end are marked.
            Toggle smoothing for a curved style, and ‚ÄúClose path‚Äù to seal the shape.
          </p>
        </details>
      </section>

      <!-- Canvas -->
      <section class="card canvas-wrap" aria-label="Canvas">
        <div class="canvas-inner">
          <canvas id="sigil" width="1200" height="1200" role="img" aria-label="Generated sigil"></canvas>
        </div>
      </section>
    </div>

    <footer>
      Made with intention. This is a creative tool; use however aligns with your practice. üíô
      <ul>
        <li><a href="index.html">‚ú® Check my magick compendium blog</a></li>
      </ul>
    </footer>
  </div>

<script>
(function(){
  const $ = sel => document.querySelector(sel);

  const canvas = $("#sigil");
  const ctx = canvas.getContext("2d");

  // UI elements
  const phraseEl = $("#phrase");
  const processedEl = $("#processed");
  const removeVowelsEl = $("#removeVowels");
  const removeDuplicatesEl = $("#removeDuplicates");
  const keepNumbersEl = $("#keepNumbers");
  const showGuideEl = $("#showGuide");
  const showLettersEl = $("#showLetters");
  const smoothEl = $("#smooth");
  const closePathEl = $("#closePath");
  const rotationEl = $("#rotation");
  const degEl = $("#deg");
  const thicknessEl = $("#thickness");
  const thkEl = $("#thk");
  const randomizeEl = $("#randomize");
  const downloadEl = $("#download");
  const clearEl = $("#clear");

  // Layout
  const W = () => canvas.width;
  const H = () => canvas.height;
  const CX = () => W()/2;
  const CY = () => H()/2;

  const LETTERS = "ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");
  const VOWELS = new Set(["A","E","I","O","U"]);

  function normalize(text, {removeVowels=true, removeDuplicates=true, keepNumbers=false}){
    // Uppercase, keep A-Z (and optionally digits)
    let t = (text || "").toUpperCase().normalize("NFKD").replace(/[^\w\s]/g, "");
    // Collapse whitespace
    t = t.replace(/\s+/g, " ").trim();

    // Filter characters
    const out = [];
    const seen = new Set();

    for (const ch of t){
      if (/[A-Z]/.test(ch)){
        if (removeVowels && VOWELS.has(ch)) continue;
        if (removeDuplicates){
          if (seen.has(ch)) continue;
          seen.add(ch);
        }
        out.push(ch);
      } else if (keepNumbers && /[0-9]/.test(ch)){
        // Map digits into letters by simple substitution 0->O, 1->I, 2->Z, 3->E, 4->A, 5->S, 6->G, 7->T, 8->B, 9->P (common leetspeak-ish)
        const map = { "0":"O","1":"I","2":"Z","3":"E","4":"A","5":"S","6":"G","7":"T","8":"B","9":"P" };
        const mapped = map[ch] || "";
        if (mapped){
          if (!(removeVowels && VOWELS.has(mapped))){
            if (!removeDuplicates || !seen.has(mapped)){
              out.push(mapped);
              seen.add(mapped);
            }
          }
        }
      }
    }
    return out.join("");
  }

  function pointsForSequence(seq, opts){
    // Equally distribute A..Z on circle
    const n = LETTERS.length;
    const rad = Math.min(W(), H()) * 0.36;
    const rot = (opts.rotationDeg || 0) * Math.PI/180; // rotation in radians
    const startAngle = -Math.PI/2 + rot; // start at top

    const pos = {};
    LETTERS.forEach((L, i) => {
      const a = startAngle + i * (2 * Math.PI / n);
      pos[L] = [CX() + rad * Math.cos(a), CY() + rad * Math.sin(a)];
    });

    return [...seq].map(ch => pos[ch]).filter(Boolean);
  }

  function drawGuide(showLetters, showOuter){
    if (!showLetters && !showOuter) return;

    ctx.save();
    ctx.lineWidth = 2;
    ctx.strokeStyle = "#1c376c";
    ctx.fillStyle = "rgba(90, 165, 255, .07)";

    const rOuter = Math.min(W(),H())*0.36;
    const rTick = rOuter + 16;

    if (showOuter){
      // outer circle
      ctx.beginPath();
      ctx.arc(CX(), CY(), rOuter, 0, Math.PI*2);
      ctx.stroke();

      // ticks
      for (let i=0;i<26;i++){
        const a = -Math.PI/2 + i*(2*Math.PI/26);
        const x1 = CX() + rOuter*Math.cos(a);
        const y1 = CY() + rOuter*Math.sin(a);
        const x2 = CX() + (rOuter+10)*Math.cos(a);
        const y2 = CY() + (rOuter+10)*Math.sin(a);
        ctx.beginPath();
        ctx.moveTo(x1,y1);
        ctx.lineTo(x2,y2);
        ctx.stroke();
      }
    }

    if (showLetters){
      ctx.font = `${Math.round(Math.min(W(),H())*0.028)}px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial`;
      ctx.textAlign = "center";
      ctx.textBaseline = "middle";
      ctx.fillStyle = "#9dc9ff";
      for (let i=0;i<26;i++){
        const a = -Math.PI/2 + i*(2*Math.PI/26);
        const x = CX() + (rTick)*Math.cos(a);
        const y = CY() + (rTick)*Math.sin(a);
        ctx.fillText(LETTERS[i], x, y);
      }
    }
    ctx.restore();
  }

  function drawSigil(points, {thickness=5, smooth=true, closePath=false} = {}){
    if (!points.length) return;

    ctx.save();

    // Glow
    ctx.shadowColor = "rgba(76, 168, 255, .5)";
    ctx.shadowBlur = 24;
    ctx.lineCap = "round";
    ctx.lineJoin = "round";
    ctx.strokeStyle = "#4aa3ff";
    ctx.lineWidth = thickness;

    // Path
    ctx.beginPath();

    if (smooth && points.length >= 3){
      // Quadratic smoothing through points
      ctx.moveTo(points[0][0], points[0][1]);
      for (let i = 1; i < points.length - 1; i++){
        const cx = (points[i][0] + points[i+1][0]) / 2;
        const cy = (points[i][1] + points[i+1][1]) / 2;
        ctx.quadraticCurveTo(points[i][0], points[i][1], cx, cy);
      }
      // last segment to final point
      const last = points[points.length-1];
      ctx.quadraticCurveTo(last[0], last[1], last[0], last[1]);
      if (closePath){
        const first = points[0];
        const midX = (last[0] + first[0]) / 2;
        const midY = (last[1] + first[1]) / 2;
        ctx.quadraticCurveTo(first[0], first[1], midX, midY);
        ctx.lineTo(first[0], first[1]);
      }
    } else {
      // Straight polyline
      ctx.moveTo(points[0][0], points[0][1]);
      for (let i=1;i<points.length;i++){
        ctx.lineTo(points[i][0], points[i][1]);
      }
      if (closePath) ctx.lineTo(points[0][0], points[0][1]);
    }

    ctx.stroke();

    // Start & end marks
    const start = points[0];
    const end = points[points.length-1];

    // Start: circle
    ctx.shadowBlur = 0;
    ctx.fillStyle = "#7cc7ff";
    ctx.beginPath();
    ctx.arc(start[0], start[1], Math.max(3, thickness*0.6), 0, Math.PI*2);
    ctx.fill();

    // End: diamond
    ctx.save();
    ctx.translate(end[0], end[1]);
    ctx.rotate(Math.PI/4);
    ctx.fillStyle = "#cfe6ff";
    const s = Math.max(5, thickness*0.8);
    ctx.fillRect(-s/2, -s/2, s, s);
    ctx.restore();

    ctx.restore();
  }

  function clearCanvas(){
    ctx.clearRect(0,0,W(),H());
  }

  function render(){
    clearCanvas();

    const flags = {
      removeVowels: removeVowelsEl.checked,
      removeDuplicates: removeDuplicatesEl.checked,
      keepNumbers: keepNumbersEl.checked
    };

    const seq = normalize(phraseEl.value, flags);
    processedEl.textContent = seq ? `Processed: ${seq}` : "Processed: ‚Äî";

    const pts = pointsForSequence(seq, {
      rotationDeg: parseInt(rotationEl.value,10) || 0
    });

    drawGuide(showLettersEl.checked, showGuideEl.checked);
    drawSigil(pts, {
      thickness: parseInt(thicknessEl.value,10) || 5,
      smooth: smoothEl.checked,
      closePath: closePathEl.checked
    });

    degEl.textContent = `${rotationEl.value}¬∞`;
    thkEl.textContent = `${thicknessEl.value}`;
  }

  // Download
  function downloadPNG(){
    const link = document.createElement("a");
    const name = (normalize(phraseEl.value, {removeVowels:false, removeDuplicates:false, keepNumbers:true}) || "sigil").toLowerCase().replace(/\s+/g,"-").slice(0,50);
    link.download = `${name}.png`;
    link.href = canvas.toDataURL("image/png");
    link.click();
  }

  // Events
  [
    phraseEl, removeVowelsEl, removeDuplicatesEl, keepNumbersEl,
    showGuideEl, showLettersEl, smoothEl, closePathEl,
    rotationEl, thicknessEl
  ].forEach(el => el.addEventListener("input", render));

  randomizeEl.addEventListener("click", () => {
    rotationEl.value = Math.floor(Math.random()*360);
    render();
  });

  downloadEl.addEventListener("click", downloadPNG);
  clearEl.addEventListener("click", () => {
    phraseEl.value = "";
    render();
    phraseEl.focus();
  });

  // Resize backing store for sharp exports
  function fitBackingStore(){
    // Keep a high-res canvas for crisp downloads regardless of CSS size
    const size = Math.min(window.innerWidth, window.innerHeight);
    const px = Math.max(800, Math.min(1600, Math.floor(size * 1.2)));
    canvas.width = px;
    canvas.height = px;
    render();
  }
  window.addEventListener("resize", fitBackingStore);

  // Initialize with a pleasant default
  phraseEl.value = "I WILL GAIN THE KNOWLEDGE AND CONVERSATION OF MY HOLY GUARDIAN ANGEL IN A DREAM";
  fitBackingStore();
})();
</script>
</body>
</html>

